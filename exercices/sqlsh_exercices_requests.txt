https://sql.sh/exercices-sql/villes-de-france


1. SELECT ville_nom FROM villes_france_free ORDER BY ville_population_2012 DESC LIMIT 10;

2. SELECT ville_nom FROM villes_france_free ORDER BY ville_surface LIMIT 50;

3. SELECT departement_nom FROM departement WHERE departement_code LIKE '97%';

4. SELECT vff.ville_nom, d.departement_nom FROM villes_france_free AS vff INNER JOIN departement AS d ON vff.ville_departement = d.departement_code ORDER BY vff.ville_population_2012 DESC LIMIT 10;

5. SELECT d.departement_nom, d.departement_code, vt.nombre_de_commune FROM departement AS d INNER JOIN (SELECT ville_departement, COUNT(*) AS nombre_de_commune FROM villes_france_free GROUP BY ville_departement) AS vt ON d.departement_code = vt.ville_departement ORDER BY vt.nombre_de_commune DESC;

6. SELECT d.departement_nom FROM departement AS d INNER JOIN (SELECT ville_departement, SUM(ville_surface) AS superficie_departement FROM villes_france_free GROUP BY ville_departement ORDER BY superficie_departement DESC LIMIT 10) AS vt ON d.departement_code = vt.ville_departement;

7. SELECT COUNT(*) AS nombre_de_ville_commencant_par_saint FROM villes_france_free WHERE ville_nom LIKE 'SAINT%';

8. SELECT ville_nom, COUNT(*) AS occurrence FROM villes_france_free GROUP BY ville_nom HAVING occurrence > 1 ORDER BY occurrence DESC;

9. SELECT ville_nom FROM villes_france_free WHERE ville_surface > (SELECT AVG(ville_surface) FROM villes_france_free);

10. SELECT d.departement_nom FROM departement AS d INNER JOIN (SELECT ville_departement, ((ville_population_2010 + ville_population_1999 + ville_population_2012) / 3) AS ville_population FROM villes_france_free HAVING ville_population > 2000000) AS vt ON d.departement_code = vt.ville_departement;

11. SELECT REPLACE(ville_nom, '-', ' ') FROM villes_france_free;






https://sql.sh/exercices-sql/commandes


1. SELECT * FROM client WHERE prenom = 'Muriel' AND password = SHA1('test11');

2. SELECT nom FROM commande_ligne GROUP BY nom HAVING COUNT(*) > 1;

3. SELECT nom, GROUP_CONCAT(DISTINCT commande_id SEPARATOR ',') AS commande_ids FROM commande_ligne GROUP BY nom HAVING COUNT(*) > 1;

4. UPDATE commande_ligne SET prix_total = quantite * prix_unitaire;

5. SELECT t1.montant_total, t2.date_achat, t3.prenom, t3.nom FROM (SELECT commande_id, SUM(prix_total) AS montant_total FROM commande_ligne GROUP BY commande_id) AS t1 LEFT JOIN commande AS t2 ON t1.commande_id = t2.id LEFT JOIN client AS t3 ON t2.client_id = t3.id;

6. UPDATE commande AS t1 LEFT JOIN (SELECT commande_id, SUM(prix_total) AS montant_total FROM commande_ligne GROUP BY commande_id) AS t2 ON t1.id = t2.commande_id SET t1.cache_prix_total = t2.montant_total;

7. SELECT MONTHNAME(date_achat) AS mois, SUM(cache_prix_total) AS montant_global FROM commande GROUP BY mois;

8. SELECT t1.prenom, t1.nom, t2.montant_total FROM client AS t1 INNER JOIN (SELECT client_id, SUM(cache_prix_total) AS montant_total FROM commande GROUP BY client_id ORDER BY montant_total DESC LIMIT 10) AS t2 ON t1.id = t2.client_id;

9. SELECT date_achat, SUM(cache_prix_total) AS montant_total FROM commande GROUP BY date_achat;

10. ALTER TABLE commande ADD category INT NOT NULL;

11. UPDATE commande SET category = (CASE WHEN cache_prix_total < 200 THEN 1 WHEN cache_prix_total >= 200 AND cache_prix_total < 500 THEN 2 WHEN cache_prix_total >= 500 AND cache_prix_total < 1000 THEN 3
 ELSE 4 END);

12. CREATE TABLE commande_category (id INT AUTO_INCREMENT PRIMARY KEY, category INT NOT NULL, CHECK (category >= 0 AND category <= 4));

13. ALTER TABLE commande_category MODIFY category int NOT NULL COMMENT 'category = 1 if commande is smaller than 200$, category = 2 if commande is greater than or equal to 200$ and commande smaller than 500$, category = 3 if commande if greater than or equal to 500$ and commande smaller than 1000$, category = 4 if commande is greater than or equal to 1000$';

14. DELETE commande, commande_ligne FROM commande INNER JOIN commande_ligne ON commande.id = commande_ligne.commande_id WHERE commande.date_achat < '2019-02-01';
